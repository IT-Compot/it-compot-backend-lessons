# –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∑–∞–∫–∞–∑–æ–≤ (Order) —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã —Ä–∞–∑–±–µ—Ä–µ–º, –∑–∞—á–µ–º –Ω–∞–º –Ω—É–∂–Ω–æ –ø—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å –∑–∞–∫–∞–∑—ã –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –∫–∞–∫ —ç—Ç–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –∏ –∫–∞–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–Ω–æ—Å–∏—Ç –≤ –Ω–∞—à –∫–æ–¥. üìå

## 1. –ü–æ—á–µ–º—É –º—ã –¥–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –º–æ–¥–µ–ª—å –∑–∞–∫–∞–∑–æ–≤?

–†–∞–Ω–µ–µ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å `Order` —Å–æ–¥–µ—Ä–∂–∞–ª–∞ —Ç–æ–ª—å–∫–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–≤–∞—Ä–µ –∏ –∞–¥—Ä–µ—Å–µ –¥–æ—Å—Ç–∞–≤–∫–∏, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∞, **–∫–∞–∫–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–¥–µ–ª–∞–ª –∑–∞–∫–∞–∑**. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ —Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–æ–±–ª–µ–º–∞–º:

- –í—Å–µ –∑–∞–∫–∞–∑—ã —Ö—Ä–∞–Ω–∏–ª–∏—Å—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö **–±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü–∞**.
- –õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ —É–≤–∏–¥–µ—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã, —Ç–∞–∫ –∫–∞–∫ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –Ω–µ –±—ã–ª–æ.
- –ú—ã –Ω–µ –º–æ–≥–ª–∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å **–∏—Å—Ç–æ—Ä–∏—é –∑–∞–∫–∞–∑–æ–≤** –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

‚úÖ –†–µ—à–µ–Ω–∏–µ ‚Äî –¥–æ–±–∞–≤–∏—Ç—å —Å–≤—è–∑—å –º–µ–∂–¥—É –∑–∞–∫–∞–∑–∞–º–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —á–µ—Ä–µ–∑ `ForeignKey`.

## 2. –ö–∞–∫ –º—ã —Ä–µ–∞–ª–∏–∑—É–µ–º –ø—Ä–∏–≤—è–∑–∫—É –∑–∞–∫–∞–∑–∞ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é?

–î–æ–ø–æ–ª–Ω—è–µ–º –º–æ–¥–µ–ª—å `Order`, –¥–æ–±–∞–≤–ª—è—è –ø–æ–ª–µ `user`:

```python
from django.db import models
from django.contrib.auth.models import User

class Product(models.Model):
    name = models.CharField(max_length=100)
    image = models.ImageField(upload_to='images/Product/')
    desc = models.TextField()
    price = models.FloatField()
    rating = models.PositiveIntegerField()

class Order(models.Model):
    user = models.ForeignKey(User, on_delete=models.SET_NULL, null=True)  # –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    product = models.ForeignKey(Product, on_delete=models.SET_NULL, null=True)
    deliverry_address = models.CharField(max_length=255)
    created_at = models.DateTimeField(auto_now_add=True)
```

### –†–∞–∑–±–æ—Ä –∫–æ–¥–∞
- `user = models.ForeignKey(User, on_delete=models.SET_NULL, null=True)` ‚Äî —Å–æ–∑–¥–∞–µ–º —Å–≤—è–∑—å ¬´–º–Ω–æ–≥–∏–µ-–∫-–æ–¥–Ω–æ–º—É¬ª, —É–∫–∞–∑—ã–≤–∞—è, —á—Ç–æ **–∫–∞–∂–¥—ã–π –∑–∞–∫–∞–∑ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –æ–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é**.
- `on_delete=models.SET_NULL, null=True` ‚Äî –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω, –∑–∞–∫–∞–∑ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –ø–æ–ª–µ `user` —Å—Ç–∞–Ω–µ—Ç `NULL`.

## 3. –ö–∞–∫ –∏–∑–º–µ–Ω–∏–ª—Å—è –∫–æ–¥ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π (views)?

–†–∞–Ω–µ–µ –º—ã –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞. –¢–µ–ø–µ—Ä—å –º—ã –ø–µ—Ä–µ–¥–∞–µ–º `request.user` –≤ `Order.objects.create()`:

```python
def order_create(request, product_id):
    if not request.user.is_authenticated:
        return redirect('signin')  # –ó–∞–ø—Ä–µ—â–∞–µ–º –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–∫–∞–∑—ã
    
    product = Product.objects.get(id=product_id)  # –ü–æ–ª—É—á–∞–µ–º —Ç–æ–≤–∞—Ä
    
    if request.method == 'POST':
        Order.objects.create(
            user=request.user,  # –°–≤—è–∑—ã–≤–∞–µ–º –∑–∞–∫–∞–∑ —Å —Ç–µ–∫—É—â–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
            product=product,
            deliverry_address=request.POST.get('delivery_address')
        )
        return redirect('orders')  # –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤
    
    return render(request, 'shop/order_create.html', {'product': product})
```

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å?
1. –ü—Ä–æ–≤–µ—Ä—è–µ–º, **–≤–æ—à–µ–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ —Å–∏—Å—Ç–µ–º—É** (`request.user.is_authenticated`).
2. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ **–ø–µ—Ä–µ–¥–∞–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** (`user=request.user`).
3. –ï—Å–ª–∏ –∑–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω, **–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞–∫–∞–∑–æ–≤**.

## 4. –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?

–†–∞–Ω—å—à–µ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ `Order.objects.all()`, —á—Ç–æ –≤—ã–≤–æ–¥–∏–ª–æ **–≤—Å–µ –∑–∞–∫–∞–∑—ã** –≤ —Å–∏—Å—Ç–µ–º–µ, –≤–∫–ª—é—á–∞—è —á—É–∂–∏–µ. –¢–µ–ø–µ—Ä—å –º—ã –ø—Ä–∏–º–µ–Ω—è–µ–º `filter(user=request.user)`, —á—Ç–æ–±—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å **—Ç–æ–ª—å–∫–æ –∑–∞–∫–∞–∑—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**:

```python
def orders(request):
    if not request.user.is_authenticated:
        return redirect('signin')
    
    orders = Order.objects.filter(user=request.user)  # –í—ã–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ –∑–∞–∫–∞–∑—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    return render(request, 'shop/orders.html', {'orders': orders})
```

### –ü–æ—á–µ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º `filter()`, –∞ –Ω–µ `all()`?
- `Order.objects.all()` ‚Äî –ø–æ–ª—É—á–∞–µ—Ç **–≤—Å–µ –∑–∞–∫–∞–∑—ã** –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
- `Order.objects.filter(user=request.user)` ‚Äî **–≤—ã–±–∏—Ä–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞–∫–∞–∑—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**.

üìå –≠—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏! –¢–µ–ø–µ—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **–Ω–µ –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å —á—É–∂–∏–µ –∑–∞–∫–∞–∑—ã**.

## 5. –ò—Ç–æ–≥
- –ú—ã **—Ä–∞—Å—à–∏—Ä–∏–ª–∏ –º–æ–¥–µ–ª—å `Order`**, –¥–æ–±–∞–≤–∏–≤ —Å–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
- –í –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è—Ö —Ç–µ–ø–µ—Ä—å **—É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**.
- –ó–∞–∫–∞–∑—ã –ø—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏.
- –î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **`filter(user=request.user)`**.

**–¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–∫–∞–∑—ã!** üöÄ

## 6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ üî•

–í—ã –º–æ–∂–µ—Ç–µ —É–ª—É—á—à–∏—Ç—å —Å–∏—Å—Ç–µ–º—É, –¥–æ–±–∞–≤–∏–≤:
- **–°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤** (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–í –æ–±—Ä–∞–±–æ—Ç–∫–µ¬ª, ¬´–î–æ—Å—Ç–∞–≤–ª–µ–Ω¬ª, ¬´–û—Ç–º–µ–Ω–µ–Ω¬ª).
- **–ò—Å—Ç–æ—Ä–∏—é –∑–∞–∫–∞–∑–æ–≤** —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –¥–∞—Ç–µ.
- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏.

üì¢ –¢–µ–ø–µ—Ä—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å —Å–º–æ–∂–µ—Ç —á–µ—Ç–∫–æ –æ–±—ä—è—Å–Ω–∏—Ç—å —É—á–µ–Ω–∏–∫–∞–º, –∑–∞—á–µ–º –Ω—É–∂–Ω—ã —ç—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –∫–∞–∫ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç! üòä

